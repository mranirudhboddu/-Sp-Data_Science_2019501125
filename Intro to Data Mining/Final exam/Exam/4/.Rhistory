getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/3")
library(caret)
library(rpart.plot)
lens=read.csv("lenses_data.csv",header = FALSE,col.names = c("1", "2", "3", "4", "5", "Label"))
View(lens)
str(lens)
summary((lens))
x_axis=lens[,1:4]
y_axis=as.factor(lens$Label)
View(x_axis)
model=rpart(y_axis~.,x_axis,control = rpart.control(minsplit = 0, minbucket = 0, cp =-1,
maxcompete = 0, maxsurrogate = 0, usesurrogate = 0, xval = 0,
maxdepth = 5))
View(model)
plot(model)
text(model)
rpart.plot(model)
sum(y == predict(model,x,type='class'))/length(y)
sum(y_axis == predict(model,x_axis,type='class'))/length(y_axis)
1-sum(y_axis == predict(model,x_axis,type='class'))/length(y_axis)
model_new=rpart(y_axis~.,x_axis,control = rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7) )
View(model_new)
plot(model_new)
text(model_new)
rpart.plot(model_new)
sum(y_axis == predict(model_new,x_axis,type='class'))/length(y_axis)
1-sum(y_axis == predict(model_new,x_axis,type='class'))/length(y_axis)
View(lens)
View(model)
View(model_new)
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/3")
library(caret)
library(rpart.plot)
lens=read.csv("lenses_data.csv",header = FALSE,col.names = c("1", "2", "3", "4", "5", "Label"))
str(lens)
summary((lens))
x=lens[,1:4]
y=as.factor(lens$Label)
model=rpart(y~.,x,control = rpart.control(minsplit = 0, minbucket = 0, cp =-1,
maxcompete = 0, maxsurrogate = 0, usesurrogate = 0, xval = 0,
maxdepth = 5))
plot(model)
text(model)
rpart.plot(model)
sum(y == predict(model,x,type='class'))/length(y)
1-sum(y == predict(model,x,type='class'))/length(y)
model_new=rpart(y~.,x,control = rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7) )
plot(model_new)
text(model_new)
rpart.plot(model_new)
sum(y == predict(model_new,x,type='class'))/length(y)
1-sum(y == predict(model_new,x,type='class'))/length(y)
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/3")
library(caret)
library(rpart.plot)
lens=read.csv("lenses_data.csv",header = FALSE,col.names = c("1", "2", "3", "4", "5", "Label"))
str(lens)
summary((lens))
x=lens[,1:4]
y=as.factor(lens$Label)
model=rpart(y~.,x,control = rpart.control(minsplit = 0, minbucket = 0, cp =-1,
maxcompete = 0, maxsurrogate = 0, usesurrogate = 0, xval = 0,
maxdepth = 5))
plot(model)
text(model)
text(model,...)
text(model)
text(model,...)
text(model,...)
text(model,)
text (model, y = NULL, labels = seq_along(model$model), adj = NULL,
pos = NULL, offset = 0.5, vfont = NULL,
cex = 1, col = NULL, font = NULL)
text (model, y = NULL, labels = seq_along(model$model), adj = NULL,
pos = NULL, offset = 0.5, vfont = NULL,
cex = 1, col = NULL, font = NULL)
text(model,...)
text(model,... = )
text(model,)
plot(model)
text(model,)
(model)
plot(model)
text(model,)
plot(model)
text(model,)
rpart.plot(model)
model_new=rpart(y~.,x,control = rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7) )
plot(model_new)
text(model_new)
rpart.plot(model_new)
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/3")
library(caret)
library(rpart.plot)
lens=read.csv("lenses_data.csv",header = FALSE,col.names = c("1", "2", "3", "4", "5", "Label"))
str(lens)
summary((lens))
x=lens[,1:4]
y=as.factor(lens$Label)
model=rpart(y~.,x,control = rpart.control(minsplit = 0, minbucket = 0, cp =-1,
maxcompete = 0, maxsurrogate = 0, usesurrogate = 0, xval = 0,
maxdepth = 5))
plot(model)
text(model,)
rpart.plot(model)
sum(y == predict(model,x,type='class'))/length(y)
1-sum(y == predict(model,x,type='class'))/length(y)
model_new=rpart(y~.,x,control = rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7) )
plot(model_new)
text(model_new)
rpart.plot(model_new)
sum(y == predict(model_new,x,type='class'))/length(y)
1-sum(y == predict(model_new,x,type='class'))/length(y)
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/4")
download.file(url = data_url, destfile = "lenses.names")
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/3")
data_url <- c("http://archive.ics.uci.edu/ml/datasets/Lenses")
download.file(url = data_url, destfile = "lenses.names")
library(caret)
library(rpart.plot)
lens=read.csv("lenses_data.csv",header = FALSE,col.names = c("1", "2", "3", "4", "5", "Label"))
str(lens)
summary((lens))
x=lens[,1:4]
y=as.factor(lens$Label)
model=rpart(y~.,x,control = rpart.control(minsplit = 0, minbucket = 0, cp =-1,
maxcompete = 0, maxsurrogate = 0, usesurrogate = 0, xval = 0,
maxdepth = 5))
plot(model)
text(model,)
rpart.plot(model)
sum(y == predict(model,x,type='class'))/length(y)
1-sum(y == predict(model,x,type='class'))/length(y)
model_new=rpart(y~.,x,control = rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7) )
plot(model_new)
text(model_new)
rpart.plot(model_new)
sum(y == predict(model_new,x,type='class'))/length(y)
1-sum(y == predict(model_new,x,type='class'))/length(y)
str(data_url)
data_url <- c("http://archive.ics.uci.edu/ml/datasets/Lenses")
download.file(url = data_url, destfile = "lenses.names")
str(data_url)
wd
wd
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/3")
str(data_url)
library(caret)
library(rpart.plot)
lens=read.csv("lenses_data.csv",header = FALSE,col.names = c("1", "2", "3", "4", "5", "Label"))
str(lens)
summary((lens))
x=lens[,1:4]
y=as.factor(lens$Label)
model=rpart(y~.,x,control = rpart.control(minsplit = 0, minbucket = 0, cp =-1,
maxcompete = 0, maxsurrogate = 0, usesurrogate = 0, xval = 0,
maxdepth = 5))
plot(model)
text(model,)
rpart.plot(model)
sum(y == predict(model,x,type='class'))/length(y)
1-sum(y == predict(model,x,type='class'))/length(y)
model_new=rpart(y~.,x,control = rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7) )
plot(model_new)
text(model_new)
rpart.plot(model_new)
sum(y == predict(model_new,x,type='class'))/length(y)
1-sum(y == predict(model_new,x,type='class'))/length(y)
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/3")
library(caret)
library(rpart.plot)
lens=read.csv("lenses_data.csv",header = FALSE,col.names = c("1", "2", "3", "4", "5", "Label"))
str(lens)
summary((lens))
x=lens[,1:4]
y=as.factor(lens$Label)
model=rpart(y~.,x,control = rpart.control(minsplit = 0, minbucket = 0, cp =-1,
maxcompete = 0, maxsurrogate = 0, usesurrogate = 0, xval = 0,
maxdepth = 5))
plot(model)
text(model,)
rpart.plot(model)
sum(y == predict(model,x,type='class'))/length(y)
1-sum(y == predict(model,x,type='class'))/length(y)
model_new=rpart(y~.,x,control = rpart.control(minsplit=0,minbucket=0,cp=-1, maxcompete=0, maxsurrogate=0, usesurrogate=0, xval=0,maxdepth=7) )
plot(model_new)
text(model_new)
rpart.plot(model_new)
sum(y == predict(model_new,x,type='class'))/length(y)
1-sum(y == predict(model_new,x,type='class'))/length(y)
getwd()
setwd("D:/Courses/2nd Year/Final exam/Exam/4")
liver=read.csv("Liver_data.csv",header = FALSE,col.names = c("mcv", "alkphos", "sgpt", "sgot", "gammagt", "drinks","selector") )
str(liver)
liver$selector <-as.factor(liver$selector)
liver$drinks <- cut(liver$drinks, breaks = c(0, 5,10,15,20),
labels = c('C1', 'C2', "C3", 'C4'), right = FALSE)
liver <- na.omit(liver)
t=subset(liver,liver$selector == 1)
View(t)
View(liver)
str(t)
test=subset(liver,liver$selector==2)
str(test)
dim(t)
dim(test)
x_t <- subset(t,select = -c(selector,drinks))
x_test <- subset(test,select = -c(selector,drinks))
View(x_t)
library(class)
y_t=t[,6,drop=TRUE]
y_test=test[,drop=TRUE]
y_test=test[,6,drop=TRUE]
length(t)
length(test)
fit1=knn(x_t,x_t,y_t,k=1)
1-sum(y_test == fit1)/length(y_test)
fit2=knn(x_t,x_t,y_t,k=2)
1-sum(y_test == fit2)/length(y_test)
fit3=knn(x_t,x_t,y_t,k=3)
1-sum(y_test == fit3)/length(y_test)
plot(fit1)
plot(fit2)
plot(fit3)
